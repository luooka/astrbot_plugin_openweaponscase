# 🔫 AstrBot CS2 武器箱开箱模拟插件

[![AstrBot Plugin](https://img.shields.io/badge/AstrBot-Plugin-blue)](https://github.com/Soulter/AstrBot)
[![Version](https://img.shields.io/badge/Version-1.2-green)]()
[![Powered By](https://img.shields.io/badge/Powered%20By-CSQAQ-orange)](https://csqaq.com)

一个用于在群聊中模拟《反恐精英 2》(CS2) 的开箱体验。支持真实的概率计算、动态 GIF 开箱动画、库存管理以及实时市场价格查询。

## ✨ 核心功能

* **🎲 真实模拟**：基于官方概率算法，支持模拟开启武器箱、纪念包和收藏品。
    * 还原军规级至非凡（金色）的概率。
    * 模拟暗金（StatTrak™）和磨损度（从崭新出厂到战痕累累）。
* **🎞️ 动态 GIF 动画**：
    * 单次开箱时会生成滚动动画。
* **📊 批量开箱**：支持十连抽或更多（显示统计概览，避免刷屏）。
* **💰 实时价格**：对接外部 API，查询饰品的 **BUFF**、**悠悠有品 (YYYP)** 和 **Steam** 实时售价。
* **🎒 库存系统**：记录每个群友的开箱历史、欧皇统计（红/金数量）。

## 📦 安装与依赖

1.  确保您已安装 AstrBot。
2.  将本插件文件夹放入 `AstrBot/data/plugins/` 目录下。
3.  本插件依赖图像处理库 `Pillow`，请确保运行环境中已安装：
    ```bash
    pip install Pillow
    ```
4.  重启 AstrBot。

## ⚙️ 配置说明

在 AstrBot 管理面板中点击本插件的【配置】按钮，或修改 `config.json`：

| 字段名 | 类型 | 默认值 | 说明 |
| :--- | :--- | :--- | :--- |
| `number` | int | `10` | 批量开箱显示的上限数（超过此数量将只显示统计文本，不发图片）。 |
| `api_host` | string | `api.csqaq.com` | 数据源 API 域名（无需加 https://）。 |
| `api_token` | string | 用来管理价格查询和库存更新使用 | API 认证 Token **(必填，获取方法见下文)**。 |
| `admins` | string | 武器箱更新权限 | **管理员 QQ 号**。多个管理员请用英文逗号分隔，例如 `12345,67890`。 |

### 🔑 如何获取 API Token

本插件依赖 **CSQAQ** 平台的数据接口。请按照以下步骤获取您的专属 Token：

1.  前往官网注册账号：[https://csqaq.com/](https://csqaq.com/)
2.  注册并登录后，点击页面右上角的 **头像**。
3.  在下拉菜单或个人中心找到 **“获取 API”** 或 **“API Token”**。
4.  复制生成的 Token，填入 AstrBot 插件配置的 `api_token` 字段中。

## 🎮 指令列表

### 用户指令

| 指令 | 示例 | 说明 |
| :--- | :--- | :--- |
| **开箱** | `开箱 变革` <br> `开箱 10 变革武器箱` | 开启指定箱子。支持模糊搜索（如“变革”）。<br>如果不写数量默认为 1（生成 GIF）。 |
| **开箱菜单** | `开箱菜单` | 查看插件帮助菜单。 |
| **武器箱列表** | `武器箱列表` | 查看当前已收录的所有武器箱、纪念包和收藏品。 |
| **库存** | `库存` | 查看自己当前的开箱统计、欧皇战绩和最近获得的稀有物品。 |
| **清除库存** | `清除库存` | 清空自己的库存记录（删档重来）。 |
| **查询价格** | `查询价格 迈阿密` | 查询指定饰品的市场价格（BUFF/YYYP/Steam）。 |
| **挂刀排行** | `挂刀排行` | 查看当前市场上的挂刀（余额兑换）比例排行。 |

### 管理员指令 (需在配置中添加 QQ)

| 指令 | 说明 |
| :--- | :--- |
| **更新武器箱** | 从 API 同步最新的箱子数据和图片链接。查询目前已包含相关数据后续可选择选择更新 |

## 🖼️ 效果展示

* **单抽动画**：
    > (此处为生成的 GIF，带有滚动条、指针和最终物品展示)
    ![temp_510591108](https://github.com/user-attachments/assets/60caaaf5-dc13-47a1-93a1-ffb3bdcc9909)

* **价格查询**：
    > [图片]
    > ★ 运动手套 | 迈阿密风云 (略有磨损)
    > BUFF: ¥12000 | YYYP: ¥11800
    > Steam: ¥14000

## 📢 特别致谢

本插件的核心数据及图片资源完全由 **[CSQAQ (https://csqaq.com/)](https://csqaq.com/)** 平台提供支持。

* **数据来源**：所有武器箱列表、物品详情、概率数据及图片链接均来自 CSQAQ。
* **平台支持**：感谢 CSQAQ 为 CS2 社区开发者提供的优质、稳定的 API 服务。

如果您觉得本插件好用，也请多多支持原数据平台！


## 📄 免责声明

插件作者与 CSQAQ 平台无直接关联，不对数据的实时准确性负责。

## 📜 开源许可 (License)

本项目采用 **MIT 许可协议** 开源。

* **代码**：您可以自由地使用、修改和分发本项目的源代码。
* **素材**：项目中涉及的《反恐精英 2》(CS2) 游戏素材（图片、名称、图标等）版权归 **Valve Corporation** 所有。
* **数据**：API 数据及图片资源由 **[CSQAQ](https://csqaq.com/)** 提供，使用时请遵守该平台的相关规定。

Copyright (c) 2026 [luooka]